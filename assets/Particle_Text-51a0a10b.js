var p=Object.defineProperty;var x=(r,t,i)=>t in r?p(r,t,{enumerable:!0,configurable:!0,writable:!0,value:i}):r[t]=i;var e=(r,t,i)=>(x(r,typeof t!="symbol"?t+"":t,i),i);class m{constructor(t,i,s,o){e(this,"effect");e(this,"color");e(this,"originalColor");e(this,"x");e(this,"y");e(this,"originX");e(this,"originY");e(this,"size");e(this,"distance");e(this,"dx");e(this,"dy");e(this,"vx");e(this,"vy");e(this,"force");e(this,"angle");e(this,"friction");e(this,"ease");var a,c;this.effect=t,this.color=o,this.originalColor=o,this.x=i,this.y=s,this.originX=i,this.originY=s,this.dx=0,this.dy=0,this.vx=0,this.vy=0,this.angle=0,this.force=0,this.distance=0,this.friction=((a=this.effect.settings.particles)==null?void 0:a.friction)??.8,this.ease=((c=this.effect.settings.particles)==null?void 0:c.ease)??.1,this.size=this.effect.particleSize}draw(){var t,i,s;Math.round(this.x)===this.originX&&Math.round(this.y)===this.originY?this.color=this.originalColor:typeof((t=this.effect.settings.particles)==null?void 0:t.trail_color)=="string"?this.color=(i=this.effect.settings.particles)==null?void 0:i.trail_color:((s=this.effect.settings.particles)==null?void 0:s.trail_color)===void 0&&(this.color=this.originalColor),this.effect.ctx.fillStyle=this.color,this.effect.ctx.fillRect(this.x,this.y,this.size,this.size)}update(){var i;let t=((i=this.effect.settings.particles)==null?void 0:i.radius)??3e3;typeof this.effect.mouse.x=="number"?this.dx=this.effect.mouse.x-this.x:this.dx=t,typeof this.effect.mouse.y=="number"?this.dy=this.effect.mouse.y-this.y:this.dy=t,this.distance=this.dx*this.dx+this.dy*this.dy,this.force=-t/this.distance,this.distance<t&&(this.angle=Math.atan2(this.dy,this.dx),this.vx+=this.force*Math.cos(this.angle),this.vy+=this.force*Math.sin(this.angle)),this.x+=(this.vx*=this.friction)+(this.originX-this.x)*this.ease,this.y+=(this.vy*=this.friction)+(this.originY-this.y)*this.ease}}class _{constructor(t,i){e(this,"canvas");e(this,"ctx");e(this,"originalWidth");e(this,"canvasMaxHeight");e(this,"text");e(this,"padding");e(this,"textX");e(this,"lineHeight");e(this,"maxTextWidth");e(this,"animationID");e(this,"checkAnimationEnd");e(this,"particles");e(this,"particleSize");e(this,"mouse");e(this,"settings");i.color=i.color||"black",i.font_family=i.font_family||"serif",i.font_size=i.font_size||16,i.stroke_color=i.stroke_color||"rgba(0, 0, 0, 0)",i.stroke_width=i.stroke_width||1,i.letter_spacing=i.letter_spacing||void 0,i.word_spacing=i.word_spacing||void 0,i.text_max_width=i.text_max_width||1,i.particles=i.particles||{},i.particles.size=i.particles.size||3,i.particles.radius=i.particles.radius||3e3,i.particles.ease=i.particles.ease||.1,i.particles.friction=i.particles.friction||.8,i.particles.trail_color=i.particles.trail_color||void 0,this.settings=i,this.canvas=document.createElement("canvas"),this.ctx=this.canvas.getContext("2d",{willReadFrequently:!0}),this.canvasMaxHeight=t.canvas_max_height,this.padding=t.padding,this.originalWidth=t.canvas_width,this.text=t.text,this.textX=t.canvas_width/2,this.lineHeight=i.font_size,this.maxTextWidth=Math.abs(i.text_max_width)>1?t.canvas_width:t.canvas_width*i.text_max_width,this.particles=[],this.particleSize=typeof i.particles.size=="number"&&i.particles.size>=1?Math.ceil(i.particles.size):3,this.mouse={x:void 0,y:void 0},this.animate=this.animate.bind(this),this.appendCanvas(t.parent,t.canvas_width,t.text),window.addEventListener("resize",()=>{this.resize(window.innerWidth)}),this.canvas.addEventListener("mouseenter",()=>{clearInterval(this.checkAnimationEnd),this.checkAnimationEnd=void 0,this.animationID||this.animate()}),this.canvas.addEventListener("mousemove",s=>{this.mouse.x=s.offsetX,this.mouse.y=s.offsetY,this.animationID||this.animate()}),this.checkAnimationEnd=void 0,this.canvas.addEventListener("mouseleave",()=>{this.mouse.x=void 0,this.mouse.y=void 0,this.checkAnimationEnd=setInterval(()=>{const s=()=>{const a=this.canvas.getBoundingClientRect();return a.bottom<=0||a.top>(window.innerHeight||document.documentElement.clientHeight)};(this.particles.every(a=>Math.round(a.x)===a.originX&&Math.round(a.y)===a.originY)||s())&&(clearInterval(this.checkAnimationEnd),this.animationID&&cancelAnimationFrame(this.animationID),this.animationID=void 0,s()&&this.wrapText(this.text))},17)})}convertToParticles(){this.particles=[];const t=this.ctx.getImageData(0,0,this.canvas.width,this.canvas.height).data;this.ctx.clearRect(0,0,this.canvas.width,this.canvas.height);for(let i=0;i<this.canvas.height;i+=this.particleSize)for(let s=0;s<this.canvas.width;s+=this.particleSize){const o=(i*this.canvas.width+s)*4;if(t[o+3]===0)continue;const a=`rgb(${t[o]}, ${t[o+1]}, ${t[o+2]})`;this.particles.push(new m(this,s,i,a)),this.particles[this.particles.length-1].draw()}}render(){this.particles.forEach(t=>{t.draw(),t.update()})}animate(){this.ctx.clearRect(0,0,this.canvas.width,this.canvas.height),this.render(),this.animationID=requestAnimationFrame(this.animate)}appendCanvas(t,i,s){t instanceof HTMLElement&&(this.canvas.width=i,this.wrapText(s),t.style.display="flex",t.style.overflow="hidden",t.appendChild(this.canvas))}wrapText(t){const i=()=>{if(this.ctx.textAlign="center",this.ctx.textBaseline="middle",this.ctx.fillStyle=`${this.settings.color}`,this.ctx.font=`${this.settings.font_size}px ${this.settings.font_family}`,this.ctx.strokeStyle=`${this.settings.stroke_color}`,this.ctx.lineWidth=this.settings.stroke_width?this.settings.stroke_width:1,this.settings.letter_spacing){let h=this.ctx;try{h.letterSpacing=this.settings.letter_spacing>0?Math.floor(this.settings.letter_spacing)+"px":0}catch{console.log("Browser doesn't support canvas .letterSpacing property")}}if(this.settings.word_spacing){let h=this.ctx;try{h.wordSpacing=this.settings.word_spacing>0?Math.floor(this.settings.word_spacing)+"px":0}catch{console.log("Browser doesn't support canvas .wordSpacing property")}}};i();let s=[],o=t.split(" "),a=0,c="";for(let h=0;h<o.length;h++){let n=c+o[h]+" ";this.ctx.measureText(n).width>this.maxTextWidth?(c=o[h]+" ",a+=1):c=n,s[a]=c}let f=this.lineHeight*a,l=typeof this.padding=="number"?Math.floor(Math.abs(this.padding)):0;if(this.canvasMaxHeight){let h=this.lineHeight*(a+1)+l;h>this.canvasMaxHeight?this.canvas.height=this.canvasMaxHeight:this.canvas.height=h}else this.canvas.height=this.lineHeight*(a+1)+l;i();let d=this.canvas.height/2-f/2;s.forEach((h,n)=>{this.ctx.fillText(h,this.textX,d+n*this.lineHeight),this.ctx.strokeText(h,this.textX,d+n*this.lineHeight)}),this.convertToParticles()}resize(t){const i=s=>{this.textX=s/2,this.settings.text_max_width&&(this.maxTextWidth=Math.abs(this.settings.text_max_width)>1?this.canvas.width:this.canvas.width*Math.abs(this.settings.text_max_width)),this.animationID&&(cancelAnimationFrame(this.animationID),this.animationID=void 0),this.wrapText(this.text)};if(t>this.originalWidth){this.canvas.width!=this.originalWidth&&(this.canvas.width=this.originalWidth,i(this.originalWidth));return}t<this.canvas.width?(this.canvas.width=t,i(t)):t>this.canvas.width&&(this.canvas.width=t,i(t))}set(t,i){typeof t.color=="string"&&(this.settings.color=t.color),typeof t.font_family=="string"&&(this.settings.font_family=t.font_family),typeof t.font_size=="number"&&(this.settings.font_size=Math.ceil(Math.abs(t.font_size))),typeof t.letter_spacing=="number"&&(this.settings.letter_spacing=Math.ceil(Math.abs(t.letter_spacing))),typeof t.stroke_color=="string"&&(this.settings.stroke_color=t.stroke_color),typeof t.stroke_width=="number"&&(this.settings.stroke_width=Math.ceil(Math.abs(t.stroke_width))),typeof t.text_max_width=="number"&&(this.maxTextWidth=Math.abs(t.text_max_width)>1?this.maxTextWidth:this.canvas.width*t.text_max_width),typeof t.word_spacing=="number"&&(this.settings.word_spacing=Math.ceil(Math.abs(t.word_spacing))),t.particles&&this.settings.particles&&(typeof t.particles.size=="number"&&(this.settings.particles.size=t.particles.size>0?Math.ceil(t.particles.size):3,this.particleSize=this.settings.particles.size),typeof t.particles.ease=="number"&&(this.settings.particles.ease=t.particles.ease),typeof t.particles.friction=="number"&&(this.settings.particles.friction=t.particles.friction),typeof t.particles.radius=="number"&&(this.settings.particles.radius=t.particles.radius),typeof t.particles.trail_color=="string"&&(t.particles.trail_color!="none"?this.settings.particles.trail_color=t.particles.trail_color:this.settings.particles.trail_color=void 0)),typeof i=="string"&&(this.text=i),(()=>{this.animationID&&(cancelAnimationFrame(this.animationID),this.animationID=void 0),this.wrapText(this.text)})()}}export{_ as E};
